---
import '../styles/global.scss';
import Navbar from '../components/Navbar.astro';

// SEO Props Interface
interface Props {
	title?: string;
	description?: string;
	keywords?: string;
	ogImage?: string;
	ogType?: string;
	canonicalUrl?: string;
	schema?: any;
	noindex?: boolean;
	structuredData?: any;
}

// Default SEO values optimized for insurance agency in Puebla
const {
	title = "GZG Seguros - Agencia de Seguros Líder en Puebla | 57 años de experiencia",
	description = "✅ Agencia de seguros líder en Puebla con más de 57 años de experiencia. Seguros de auto, vida, gastos médicos y hogar. Cotiza gratis ☎️ 222-123-4567",
	keywords = "seguros puebla, seguros de auto puebla, agencia de seguros puebla, seguro médico puebla, seguros de vida puebla, seguros hogar puebla, cotizar seguro puebla, aseguradora puebla, seguros vehiculares puebla, seguros gastos médicos puebla",
	ogImage = "/logo.png",
	ogType = "website",
	canonicalUrl = Astro.url.href,
	schema = null,
	noindex = false,
	structuredData = null
} = Astro.props;

// Base URL for absolute URLs
const baseUrl = "https://gzgseguros.com";
const fullCanonicalUrl = canonicalUrl.startsWith('http') ? canonicalUrl : `${baseUrl}${canonicalUrl}`;

// Default Local Business Schema for Insurance Agency
const defaultSchema = {
	"@context": "https://schema.org",
	"@type": "InsuranceAgency",
	"name": "GZG Seguros",
	"alternateName": "GZG Seguros Puebla",
	"description": "Agencia de seguros líder en Puebla con más de 57 años de experiencia especializada en seguros de auto, vida, gastos médicos y hogar",
	"url": baseUrl,
	"logo": `${baseUrl}/logo.png`,
	"image": `${baseUrl}/logo.png`,
	"telephone": "+52-222-123-4567",
	"email": "contacto@gzgseguros.com",
	"foundingDate": "1967",
	"slogan": "Tu tranquilidad es nuestro compromiso",
	"address": {
		"@type": "PostalAddress",
		"streetAddress": "Av. Juárez 2504, Col. La Paz",
		"addressLocality": "Puebla",
		"addressRegion": "Puebla",
		"postalCode": "72160",
		"addressCountry": "MX"
	},
	"geo": {
		"@type": "GeoCoordinates",
		"latitude": 19.0414,
		"longitude": -98.2063
	},
	"openingHours": [
		"Mo-Fr 09:00-18:00",
		"Sa 09:00-14:00"
	],
	"priceRange": "$$$",
	"paymentAccepted": "Cash, Credit Card, Debit Card, Bank Transfer",
	"currenciesAccepted": "MXN",
	"areaServed": {
		"@type": "State",
		"name": "Puebla"
	},
	"serviceArea": {
		"@type": "GeoCircle",
		"geoMidpoint": {
			"@type": "GeoCoordinates",
			"latitude": 19.0414,
			"longitude": -98.2063
		},
		"geoRadius": "50000"
	},
	"sameAs": [
		"https://web.facebook.com/people/GZGseguros/61567781244316",
		"https://www.instagram.com/gzgseguros",
		"https://www.linkedin.com/company/gzgseguros",
		"https://wa.me/2228340689"
	],
	"hasOfferCatalog": {
		"@type": "OfferCatalog",
		"name": "Seguros disponibles",
		"itemListElement": [
			{
				"@type": "Offer",
				"itemOffered": {
					"@type": "Service",
					"name": "Seguro de Auto",
					"description": "Cobertura completa para vehículos en Puebla"
				}
			},
			{
				"@type": "Offer",
				"itemOffered": {
					"@type": "Service",
					"name": "Seguro de Gastos Médicos",
					"description": "Protección médica integral para toda la familia"
				}
			},
			{
				"@type": "Offer",
				"itemOffered": {
					"@type": "Service",
					"name": "Seguro de Vida",
					"description": "Protección financiera para tu familia"
				}
			},
			{
				"@type": "Offer",
				"itemOffered": {
					"@type": "Service",
					"name": "Seguro de Hogar",
					"description": "Protección integral para tu patrimonio"
				}
			}
		]
	},
	"aggregateRating": {
		"@type": "AggregateRating",
		"ratingValue": "4.8",
		"reviewCount": "150",
		"bestRating": "5"
	},
	"review": [
		{
			"@type": "Review",
			"reviewRating": {
				"@type": "Rating",
				"ratingValue": "5"
			},
			"author": {
				"@type": "Person",
				"name": "María González"
			},
			"reviewBody": "Excelente servicio, muy profesionales y buenos precios en seguros de auto."
		}
	]
};

// Combine schemas
const finalSchema = schema ? (Array.isArray(schema) ? [...schema, defaultSchema] : [schema, defaultSchema]) : defaultSchema;
---

<!doctype html>
<html lang="es-MX">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		
		<!-- SEO Meta Tags -->
		<title>{title}</title>
		<meta name="description" content={description} />
		<meta name="keywords" content={keywords} />
		<meta name="author" content="GZG Seguros" />
		<meta name="robots" content={noindex ? "noindex,nofollow" : "index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1"} />
		<meta name="googlebot" content="index,follow" />
		<meta name="bingbot" content="index,follow" />
		
		<!-- Canonical URL -->
		<link rel="canonical" href={fullCanonicalUrl} />
		
		<!-- Open Graph / Facebook -->
		<meta property="og:type" content={ogType} />
		<meta property="og:url" content={fullCanonicalUrl} />
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
		<meta property="og:image" content={`${baseUrl}${ogImage}`} />
		<meta property="og:image:width" content="1200" />
		<meta property="og:image:height" content="630" />
		<meta property="og:site_name" content="GZG Seguros" />
		<meta property="og:locale" content="es_MX" />
		
		<!-- Twitter -->
		<meta property="twitter:card" content="summary_large_image" />
		<meta property="twitter:url" content={fullCanonicalUrl} />
		<meta property="twitter:title" content={title} />
		<meta property="twitter:description" content={description} />
		<meta property="twitter:image" content={`${baseUrl}${ogImage}`} />
		<meta property="twitter:site" content="@gzgseguros" />
		<meta property="twitter:creator" content="@gzgseguros" />
		
		<!-- Business/Local SEO -->
		<meta name="geo.region" content="MX-PUE" />
		<meta name="geo.placename" content="Puebla" />
		<meta name="geo.position" content="19.0414;-98.2063" />
		<meta name="ICBM" content="19.0414, -98.2063" />
		
		<!-- Mobile/PWA -->
		<meta name="mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="default" />
		<meta name="apple-mobile-web-app-title" content="GZG Seguros" />
		
		<!-- Favicon -->
		<link rel="icon" type="image/svg+xml" href="/favicon.png" />
		<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
		<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
		<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
		<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#1e40af" />
		
		<!-- Preconnect for performance -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link rel="preconnect" href="https://www.google-analytics.com" />
		<link rel="preconnect" href="https://www.googletagmanager.com" />
		
		<!-- DNS Prefetch -->
		<link rel="dns-prefetch" href="//fonts.googleapis.com" />
		<link rel="dns-prefetch" href="//www.google-analytics.com" />
		<link rel="dns-prefetch" href="//api.whatsapp.com" />
		
		<!-- Structured Data -->
		<script type="application/ld+json" set:html={JSON.stringify(finalSchema)} />
		
		<!-- Additional structured data if provided -->
		{structuredData && (
			<script type="application/ld+json" set:html={JSON.stringify(structuredData)} />
		)}
		
		<!-- Generator -->
		<meta name="generator" content={Astro.generator} />
		
		<!-- Astro SEO -->
		<meta name="astro-version" content="4.0" />
		
		<!-- Performance hints -->
		<link rel="preload" href="/fonts/main.woff2" as="font" type="font/woff2" crossorigin />
		
		<!-- Security -->
		<meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://www.googletagmanager.com https://www.google-analytics.com https://connect.facebook.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https://www.google-analytics.com https://www.googletagmanager.com; connect-src 'self' https://www.google-analytics.com https://api.whatsapp.com; frame-src https://www.google.com;" />
	</head>
	<body>
		<Navbar />
		<main>
			<slot />
		</main>
		
		<!-- Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
		<script is:inline>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'GA_MEASUREMENT_ID');
		</script>
		
		<!-- WhatsApp Chat Widget -->
		<script is:inline>
			// WhatsApp floating button functionality
			document.addEventListener('DOMContentLoaded', function() {
				// Add WhatsApp chat functionality here
				console.log('WhatsApp chat initialized');
			});
		</script>
	</body>
</html>

<style>
	html {
		font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
		scroll-behavior: smooth;
	}
	
	body {
		margin: 0;
		width: 100%;
		min-height: 100%;
		background-color: #ffffff;
		color: #1f2937;
		line-height: 1.6;
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
	}
	
	main {
		min-height: 100vh;
	}
	
	/* Accessibility improvements */
	@media (prefers-reduced-motion: reduce) {
		html {
			scroll-behavior: auto;
		}
		
		*, *::before, *::after {
			animation-duration: 0.01ms !important;
			animation-iteration-count: 1 !important;
			transition-duration: 0.01ms !important;
		}
	}
	
	/* Print styles */
	@media print {
		body {
			background: white;
			color: black;
		}
		
		nav, .no-print {
			display: none !important;
		}
	}
</style>
